/*!
 * Carty - v0.1.0 - 2015-03-10
 * http://sorgalla.com/carty/
 * Copyright (c) 2015 Jan Sorgalla; Licensed MIT
 */
!function(t,n){"object"==typeof exports&&"object"==typeof module?module.exports=n():"function"==typeof define&&define.amd?define(n):"object"==typeof exports?exports.carty=n():t.carty=n()}(this,function(){return function(t){function n(e){if(r[e])return r[e].exports;var o=r[e]={exports:{},id:e,loaded:!1};return t[e].call(o.exports,o,o.exports,n),o.loaded=!0,o.exports}var r={};return n.m=t,n.c=r,n.p="/",n(0)}([function(t,n,r){var e=r(1),o=r(2),u=e;u.item=o,t.exports=u},function(t,n,r){"use strict";function e(t){function n(){return h.slice(0)}function r(t){j["catch"](function(t){setTimeout(function(){throw t})}),j=j.then(function(){return t(n)})}function e(t){j=j["catch"](function(r){return t(r,n)})}function d(){return s(b?b.load():[]).then(function(t){Array.isArray(t)&&(h=t.map(function(t){return f(t)}))})}function y(t){var n,r=!1;try{n=f(t)}catch(e){return!1}return h.every(function(t,e){return n.equals(t)&&(r={item:t,index:e}),!r}),r}function v(t){var r=f(t);if(O("add",r)){var e=y(r);return e&&(r=f(o({},e.item(),r(),{quantity:e.item.quantity()+r.quantity()}))),r.quantity()<1?m(r):(e?h[e.index]=r:h.push(r),s(b?b.add(r,n):null).then(O.bind(n,"added",r),function(t){return O("addfailed",t,r),l(t)}))}}function m(t){var r=y(t);if(r&&O("remove",r.item))return h.splice(r.index,1),s(b?b.remove(r.item,n):null).then(O.bind(n,"removed",r.item),function(t){return O("removefailed",t,r.item),l(t)})}function g(){return O("clear")?(h.length=0,s(b?b.clear():null).then(O.bind(n,"cleared"),function(t){return O("clearfailed",t),l(t)})):void 0}var x=o({},p,t),b=x.storage,h=[],j=d(),O=u(n);return n.ready=function(t){return r(t),n},n.error=function(t){return e(t),n},n.option=c.bind(n,x),n.size=function(){return h.length},n.has=function(t){return!!y(t)},n.get=function(t){var n=y(t);return n?n.item:null},n.add=function(t){return r(v.bind(n,t)),n},n.remove=function(t){return r(m.bind(n,t)),n},n.clear=function(){return r(g),n},n.each=function(t,r){return h.every(function(e,o){return!1!==t.call(r,e,o,n)}),n},n.quantity=function(){return n().reduce(function(t,n){return t+n.quantity()},0)},n.subtotal=function(){return n().reduce(function(t,n){return t+n.price()*n.quantity()},0)},n.currency=function(){return x.currency},n.shipping=function(){return n.size()?n().reduce(function(t,n){return t+n.shipping()},i(a(x.shipping,n))):0},n.tax=function(){return n.size()?n().reduce(function(t,n){return t+n.tax()},i(a(x.tax,n))):0},n.total=function(){return n.subtotal()+n.tax()+n.shipping()},n}var o=r(8),u=r(3),i=r(4),c=r(5),a=r(6),f=r(2),s=Promise.resolve.bind(Promise),l=Promise.reject.bind(Promise),p={storage:null,currency:"USD",shipping:null,tax:null};e.option=c.bind(e,p),t.exports=e},function(t,n,r){function e(t){function n(){return o({},r)}"function"===i(t)&&(t=t()),"string"===i(t)&&(t={id:t});var r=o({},c,t);if(!r.id)throw"Item must be a string or an object with at least an id property.";return n.id=function(){return r.id},n.label=function(){return r.label||r.id},n.quantity=function(){return u(r.quantity)},n.price=function(){return u(r.price)},n.currency=function(){return r.currency},n.shipping=function(){return u(r.shipping)},n.tax=function(){return u(r.tax)},n.variant=function(){return r.variant},n.equals=function(t){try{var r=e(t)}catch(o){return!1}if(r.id()!==n.id())return!1;var u=i(n.variant());if(i(r.variant())!==u)return!1;var c=n.variant(),a=r.variant();return"object"===u||"array"===u?Object.keys(c).every(function(t){return"undefined"!==i(a[t])&&a[t]===c[t]}):a===c},n}var o=r(8),u=r(4),i=r(7),c={quantity:1,price:0,currency:null,shipping:0,tax:0,variant:null};t.exports=e},function(t){"use strict";var n=Array.isArray;t.exports=function(t){var r={};return t.on=function(e,o){return n(e)?e.forEach(function(n){t.on(n,o)}):(r["$"+e]=r["$"+e]||[]).push(o),t},t.once=function(r,e){function o(){t.off(r,o),e.apply(t,arguments)}return n(r)?(r.forEach(function(n){t.once(n,e)}),t):(o.fn=e,t.on(r,o),t)},t.off=function(e,o){if(0==arguments.length)return r={},t;if(n(e))return e.forEach(function(n){t.off(n,o)}),t;var u=r["$"+e];if(!u)return t;if(1==arguments.length)return delete r["$"+e],t;for(var i,c=0;c<u.length;c++)if(i=u[c],i===o||i.fn===o){u.splice(c,1);break}return t},function e(o){var u=[].slice.call(arguments,1),i=!0;if(n(o))return o.forEach(function(n){!1===e.apply(t,[n].concat(u))&&(i=!1)}),i;var c=r["$"+o];if(c){c=c.slice(0);for(var a=0,f=c.length;f>a;++a)!1===c[a].apply(t,u)&&(i=!1)}return i}}},function(t){t.exports=function(t,n){var r=parseFloat(t);if(isFinite(r))return r;var e=""+t;if(!n){var o=e.indexOf("."),u=e.indexOf(",");n=".",o>-1&&u>-1&&u>o&&(n=",")}var i=new RegExp("[^0-9-"+n+"]",["g"]);return parseFloat(e.replace(/\(([^-]+)\)/,"-$1").replace(i,"").replace(n,"."))||0}},function(t,n,r){var e=r(8),o=r(7);t.exports=function(t,n){return 1===arguments.length?e(!0,{},t):n&&"undefined"!==o(t[n])?t[n]:null}},function(t,n,r){var e=r(7);t.exports=function o(o,t,n){return"function"===e(o)?o.apply(t,n||[]):o}},function(t){var n={"[object Arguments]":"arguments","[object Array]":"array","[object Date]":"date","[object Function]":"function","[object Number]":"number","[object RegExp]":"regexp","[object String]":"string"};t.exports=function(t){var r=Object.prototype.toString.call(t);return n[r]?n[r]:null===t?"null":void 0===t?"undefined":t===Object(t)?"object":typeof t}},function(t){var n,r=Object.prototype.hasOwnProperty,e=Object.prototype.toString,o=function(t){"use strict";if(!t||"[object Object]"!==e.call(t))return!1;var o=r.call(t,"constructor"),u=t.constructor&&t.constructor.prototype&&r.call(t.constructor.prototype,"isPrototypeOf");if(t.constructor&&!o&&!u)return!1;var i;for(i in t);return i===n||r.call(t,i)};t.exports=function u(){"use strict";var t,r,e,i,c,a,f=arguments[0],s=1,l=arguments.length,p=!1;for("boolean"==typeof f?(p=f,f=arguments[1]||{},s=2):("object"!=typeof f&&"function"!=typeof f||null==f)&&(f={});l>s;++s)if(t=arguments[s],null!=t)for(r in t)e=f[r],i=t[r],f!==i&&(p&&i&&(o(i)||(c=Array.isArray(i)))?(c?(c=!1,a=e&&Array.isArray(e)?e:[]):a=e&&o(e)?e:{},f[r]=u(p,a,i)):i!==n&&(f[r]=i));return f}}])});