/*!
 * Carty - v0.1.0 - 2015-03-09
 * http://sorgalla.com/carty/
 * Copyright (c) 2015 Jan Sorgalla; Licensed MIT
 */
!function(t,n){"object"==typeof exports&&"object"==typeof module?module.exports=n():"function"==typeof define&&define.amd?define(n):"object"==typeof exports?exports.carty=n():t.carty=n()}(this,function(){return function(t){function n(e){if(r[e])return r[e].exports;var u=r[e]={exports:{},id:e,loaded:!1};return t[e].call(u.exports,u,u.exports,n),u.loaded=!0,u.exports}var r={};return n.m=t,n.c=r,n.p="/",n(0)}([function(t,n,r){var e=r(1),u=r(2),o=e;o.item=u,t.exports=o},function(t,n,r){"use strict";function e(t){function n(){return b.slice(0)}function r(t,r){(t||r)&&(h=h.then(t?function(){return t(n)}:null,r?function(t){return r(t,n)}:null))}function e(){return l(g?g.load():[]).then(function(t){b=t.map(function(t){return f(t)})})}function d(t){var n,r=!1;try{n=f(t)}catch(e){return!1}return b.every(function(t,e){return n.equals(t)&&(r={item:t,index:e}),!r}),r}function y(t){var r=f(t);if(j("add",r)){var e=d(r);return e&&(r=f(u({},e.item(),r(),{quantity:e.item.quantity()+r.quantity()}))),r.quantity()<1?m(r):(e?b[e.index]=r:b.push(r),l(g?g.add(r,n):null).then(j.bind(n,"added",r),function(t){return j("addfailed",t,r),s(t)}))}}function m(t){var r=d(t);if(r&&j("remove",r.item))return b.splice(r.index,1),l(g?g.remove(r.item,n):null).then(j.bind(n,"removed",r.item),function(t){return j("removefailed",t,r.item),s(t)})}function v(){return j("clear")?(b.length=0,l(g?g.clear():null).then(j.bind(n,"cleared"),function(t){return j("clearfailed",t),s(t)})):void 0}var x=u({},p,t),g=x.store,b=[],h=e(),j=o(n);return n.ready=function(t){return r(t),n},n.error=function(t){return r(null,t),n},n.option=c.bind(n,x),n.size=function(){return b.length},n.has=function(t){return!!d(t)},n.get=function(t){var n=d(t);return n?n.item:null},n.add=function(t){return r(y.bind(n,t)),n},n.remove=function(t){return r(m.bind(n,t)),n},n.clear=function(){return r(v),n},n.each=function(t,r){return b.every(function(e,u){return!1!==t.call(r,e,u,n)}),n},n.quantity=function(){return n().reduce(function(t,n){return t+n.quantity()},0)},n.total=function(){return n().reduce(function(t,n){return t+n.price()*n.quantity()},0)},n.currency=function(){return x.currency},n.shipping=function(){return n.size()?n().reduce(function(t,n){return t+n.shipping()},i(a(x.shipping,n))):0},n.tax=function(){return n.size()?n().reduce(function(t,n){return t+n.tax()},i(a(x.tax,n))):0},n.grandTotal=function(){return n.total()+n.tax()+n.shipping()},n}var u=r(8),o=r(3),i=r(4),c=r(5),a=r(6),f=r(2),l=Promise.resolve.bind(Promise),s=Promise.reject.bind(Promise),p={store:null,currency:"USD",shipping:null,tax:null};e.option=c.bind(e,p),t.exports=e},function(t,n,r){function e(t){function n(){return u({},r)}if("function"===i(t)&&(t=t()),"string"===i(t)&&(t={id:t}),!t.id)throw"Item must be a string or an object with at least an id property.";var r=u({},c,t);return n.id=function(){return r.id},n.label=function(){return r.label||r.id},n.quantity=function(){return o(r.quantity)},n.price=function(){return o(r.price)},n.currency=function(){return r.currency},n.shipping=function(){return o(r.shipping)},n.tax=function(){return o(r.tax)},n.equals=function(t){try{return e(t).id()===n.id()}catch(r){return!1}},n}var u=r(8),o=r(4),i=r(7),c={quantity:1,price:0,currency:null,shipping:0,tax:0};t.exports=e},function(t){"use strict";t.exports=function(t){var n={};return t.on=function(r,e){return(n["$"+r]=n["$"+r]||[]).push(e),t},t.once=function(n,r){function e(){t.off(n,e),r.apply(t,arguments)}return e.fn=r,t.on(n,e),t},t.off=function(r,e){if(0==arguments.length)return n={},t;var u=n["$"+r];if(!u)return t;if(1==arguments.length)return delete n["$"+r],t;for(var o,i=0;i<u.length;i++)if(o=u[i],o===e||o.fn===e){u.splice(i,1);break}return t},function(r){var e=[].slice.call(arguments,1),u=n["$"+r],o=!0;if(u){u=u.slice(0);for(var i=0,c=u.length;c>i;++i)u[i].apply(t,e)||(o=!1)}return o}}},function(t){t.exports=function(t,n){var r=parseFloat(t);if(isFinite(r))return r;var e=""+t;if(!n){var u=e.indexOf("."),o=e.indexOf(",");n=".",u>-1&&o>-1&&o>u&&(n=",")}var i=new RegExp("[^0-9-"+n+"]",["g"]);return parseFloat(e.replace(/\(([^-]+)\)/,"-$1").replace(i,"").replace(n,"."))||0}},function(t,n,r){var e=r(8),u=r(7);t.exports=function(t,n){return 1===arguments.length?e(!0,{},t):n&&"undefined"!==u(t[n])?t[n]:null}},function(t,n,r){var e=r(7);t.exports=function u(u,t,n){return"function"===e(u)?u.apply(t,n||[]):u}},function(t){var n={"[object Arguments]":"arguments","[object Array]":"array","[object Date]":"date","[object Function]":"function","[object Number]":"number","[object RegExp]":"regexp","[object String]":"string"};t.exports=function(t){var r=Object.prototype.toString.call(t);return n[r]?n[r]:null===t?"null":void 0===t?"undefined":t===Object(t)?"object":typeof t}},function(t){var n,r=Object.prototype.hasOwnProperty,e=Object.prototype.toString,u=function(t){"use strict";if(!t||"[object Object]"!==e.call(t))return!1;var u=r.call(t,"constructor"),o=t.constructor&&t.constructor.prototype&&r.call(t.constructor.prototype,"isPrototypeOf");if(t.constructor&&!u&&!o)return!1;var i;for(i in t);return i===n||r.call(t,i)};t.exports=function o(){"use strict";var t,r,e,i,c,a,f=arguments[0],l=1,s=arguments.length,p=!1;for("boolean"==typeof f?(p=f,f=arguments[1]||{},l=2):("object"!=typeof f&&"function"!=typeof f||null==f)&&(f={});s>l;++l)if(t=arguments[l],null!=t)for(r in t)e=f[r],i=t[r],f!==i&&(p&&i&&(u(i)||(c=Array.isArray(i)))?(c?(c=!1,a=e&&Array.isArray(e)?e:[]):a=e&&u(e)?e:{},f[r]=o(p,a,i)):i!==n&&(f[r]=i));return f}}])});