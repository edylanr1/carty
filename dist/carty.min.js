!function(a){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=a();else if("function"==typeof define&&define.amd)define([],a);else{var b;b="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this,b.carty=a()}}(function(){return function a(b,c,d){function e(g,h){if(!c[g]){if(!b[g]){var i="function"==typeof require&&require;if(!h&&i)return i(g,!0);if(f)return f(g,!0);var j=new Error("Cannot find module '"+g+"'");throw j.code="MODULE_NOT_FOUND",j}var k=c[g]={exports:{}};b[g][0].call(k.exports,function(a){var c=b[g][1][a];return e(c?c:a)},k,k.exports,a,b,c,d)}return c[g].exports}for(var f="function"==typeof require&&require,g=0;g<d.length;g++)e(d[g]);return e}({1:[function(a,b){"use strict";function c(a){function b(){return t.slice(0)}function c(a,c){(a||c)&&(u=u.then(a?function(){return a(b)}:null,c?function(a){return c(a,b)}:null))}function m(){return j(s?s.load():[]).then(function(a){t=a.map(function(a){return i(a)})})}function n(a){var b,c=!1;try{b=i(a)}catch(d){return!1}return t.every(function(a,d){return b.equals(a)&&(c={item:a,index:d}),!c}),c}function o(a){var c=i(a);if(v("add",c)){var e=n(c);return e&&(c=i(d({},e.item(),c(),{quantity:e.item.quantity()+c.quantity()}))),c.quantity()<1?p(c):(e?t[e.index]=c:t.push(c),j(s?s.add(c,b):null).then(v.bind(b,"added",c),function(a){return v("addfailed",a,c),k(a)}))}}function p(a){var c=n(a);if(c&&v("remove",c.item))return t.splice(c.index,1),j(s?s.remove(c.item,b):null).then(v.bind(b,"removed",c.item),function(a){return v("removefailed",a,c.item),k(a)})}function q(){return v("clear")?(t.length=0,j(s?s.clear():null).then(v.bind(b,"cleared"),function(a){return v("clearfailed",a),k(a)})):void 0}var r=d({},l,a),s=r.store,t=[],u=m(),v=e(b);return b.ready=function(a){return c(a),b},b.error=function(a){return c(null,a),b},b.option=g.bind(b,r),b.size=function(){return t.length},b.has=function(a){return!!n(a)},b.get=function(a){var b=n(a);return b?b.item:null},b.add=function(a){return c(o.bind(b,a)),b},b.remove=function(a){return c(p.bind(b,a)),b},b.clear=function(){return c(q),b},b.each=function(a,c){return t.every(function(d,e){return!1!==a.call(c,d,e,b)}),b},b.quantity=function(){return b().reduce(function(a,b){return a+b.quantity()},0)},b.total=function(){return b().reduce(function(a,b){return a+b.price()*b.quantity()},0)},b.currency=function(){return r.currency},b.shipping=function(){return b.size()?b().reduce(function(a,b){return a+b.shipping()},f(h(r.shipping,b))):0},b.tax=function(){return b.size()?b().reduce(function(a,b){return a+b.tax()},f(h(r.tax,b))):0},b.grandTotal=function(){return b.total()+b.tax()+b.shipping()},b}var d=a("extend"),e=a("./util/emitter"),f=a("./util/number"),g=a("./util/property"),h=a("./util/value"),i=a("./item"),j=Promise.resolve.bind(Promise),k=Promise.reject.bind(Promise),l={store:null,currency:"USD",shipping:null,tax:null};c.option=g.bind(c,l),b.exports=c},{"./item":3,"./util/emitter":5,"./util/number":6,"./util/property":7,"./util/value":9,extend:4}],2:[function(a,b){var c=a("./cart"),d=a("./item"),e=c;e.item=d,b.exports=e},{"./cart":1,"./item":3}],3:[function(a,b){function c(a){function b(){return d({},h)}if("function"===f(a)&&(a=a()),"string"===f(a)&&(a={id:a}),!a.id)throw"Item must be a string or an object with at least an id property.";var h=d({},g,a);return b.id=function(){return h.id},b.label=function(){return h.label||h.id},b.quantity=function(){return e(h.quantity)},b.price=function(){return e(h.price)},b.currency=function(){return h.currency},b.shipping=function(){return e(h.shipping)},b.tax=function(){return e(h.tax)},b.equals=function(a){try{return c(a).id()===b.id()}catch(d){return!1}},b}var d=a("extend"),e=a("./util/number"),f=a("./util/type"),g={quantity:1,price:0,currency:null,shipping:0,tax:0};b.exports=c},{"./util/number":6,"./util/type":8,extend:4}],4:[function(a,b){var c,d=Object.prototype.hasOwnProperty,e=Object.prototype.toString,f=function(a){"use strict";if(!a||"[object Object]"!==e.call(a))return!1;var b=d.call(a,"constructor"),f=a.constructor&&a.constructor.prototype&&d.call(a.constructor.prototype,"isPrototypeOf");if(a.constructor&&!b&&!f)return!1;var g;for(g in a);return g===c||d.call(a,g)};b.exports=function g(){"use strict";var a,b,d,e,h,i,j=arguments[0],k=1,l=arguments.length,m=!1;for("boolean"==typeof j?(m=j,j=arguments[1]||{},k=2):("object"!=typeof j&&"function"!=typeof j||null==j)&&(j={});l>k;++k)if(a=arguments[k],null!=a)for(b in a)d=j[b],e=a[b],j!==e&&(m&&e&&(f(e)||(h=Array.isArray(e)))?(h?(h=!1,i=d&&Array.isArray(d)?d:[]):i=d&&f(d)?d:{},j[b]=g(m,i,e)):e!==c&&(j[b]=e));return j}},{}],5:[function(a,b){"use strict";b.exports=function(a){var b={};return a.on=function(c,d){return(b["$"+c]=b["$"+c]||[]).push(d),a},a.once=function(b,c){function d(){a.off(b,d),c.apply(a,arguments)}return d.fn=c,a.on(b,d),a},a.off=function(c,d){if(0==arguments.length)return b={},a;var e=b["$"+c];if(!e)return a;if(1==arguments.length)return delete b["$"+c],a;for(var f,g=0;g<e.length;g++)if(f=e[g],f===d||f.fn===d){e.splice(g,1);break}return a},function(c){var d=[].slice.call(arguments,1),e=b["$"+c],f=!0;if(e){e=e.slice(0);for(var g=0,h=e.length;h>g;++g)e[g].apply(a,d)||(f=!1)}return f}}},{}],6:[function(a,b){b.exports=function(a,b){var c=parseFloat(a);if(isFinite(c))return c;var d=""+a;if(!b){var e=d.indexOf("."),f=d.indexOf(",");b=".",e>-1&&f>-1&&f>e&&(b=",")}var g=new RegExp("[^0-9-"+b+"]",["g"]);return parseFloat(d.replace(/\(([^-]+)\)/,"-$1").replace(g,"").replace(b,"."))||0}},{}],7:[function(a,b){var c=a("extend"),d=a("./type");b.exports=function(a,b){return 1===arguments.length?c(!0,{},a):b&&"undefined"!==d(a[b])?a[b]:null}},{"./type":8,extend:4}],8:[function(a,b){var c={"[object Arguments]":"arguments","[object Array]":"array","[object Date]":"date","[object Function]":"function","[object Number]":"number","[object RegExp]":"regexp","[object String]":"string"};b.exports=function(a){var b=Object.prototype.toString.call(a);return c[b]?c[b]:null===a?"null":void 0===a?"undefined":a===Object(a)?"object":typeof a}},{}],9:[function(a,b){var c=a("./type");b.exports=function d(d,a,b){return"function"===c(d)?d.apply(a,b||[]):d}},{"./type":8}]},{},[2])(2)});